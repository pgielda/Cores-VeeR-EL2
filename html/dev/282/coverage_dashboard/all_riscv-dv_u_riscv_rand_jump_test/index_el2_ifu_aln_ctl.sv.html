<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>
        Full
        coverage report
    </title>
    <link rel="stylesheet" type="text/css" href="cov.css">
    <style>
        .container {
            background-color: rgb(169, 169, 169);
            width: 100%;
            min-height: 80%;
            border-radius: 15px;
        }
    </style>
</head>

<body>
    <table class="title-header-shadow">
        <td class="title-container">
            <table class="title-header">
                <td class="title-logo">
                    <a href=index.html>
                        <img src=_static/white.svg></img>
                    </a>
                </td>
                <td class="title">
                    Project
                    Full
                    coverage report
                </td>
            </table>
        </td>
    </table>
    <center>
        <table class="info-table">
            <tr class="info-table-view">
                <td width="10%" class="headerInfo">Current view:</td>
                <td width="40%" class="headerInfoValue">
                    <a href=index.html>Cores-VeeR-EL2</a>—Cores-VeeR-EL2—design—ifu—el2_ifu_aln_ctl.sv
                </td>
                <td width=auto></td>
                <td width="10%"></td>
                <td width="10%" class="headerCovSummary colTop">Coverage</td>
                <td width="10%" class="headerCovSummary colTop" title="Covered + Uncovered code">Hit</td>
                <td width="10%" class="headerCovSummary colTop" title="Exercised code only">Total</td>
            </tr>
            <tr>
                <td class="headerInfo">Test Date:</td>
                <td class="headerInfoValue">
                    29-11-2024
                </td>
                <td></td>
                
    <td class="headerCovSummary rowLeft">
        Toggle
    </td>
    <td class="headerCovSummaryEntry" style="color: #0E1116; background-color: #45ff00;">
        86.3%
    </td>
    <td class="headerCovSummaryEntry">
        107
    </td>
    <td class="headerCovSummaryEntry">
        124
    </td>

            </tr>
            <tr>
                <td class="headerInfo">Test:</td>
                <td class="headerInfoValue">
                    riscv-dv_u_riscv_rand_jump_test
                </td>
                <td></td>
                
    <td class="headerCovSummary rowLeft">
        Branch
    </td>
    <td class="headerCovSummaryEntry" style="color: #0E1116; background-color: #14ff00;">
        96.0%
    </td>
    <td class="headerCovSummaryEntry">
        24
    </td>
    <td class="headerCovSummaryEntry">
        25
    </td>

            </tr>
            
        </table>
    </center>

    <table border="0" cellpadding="0" cellspacing="0">
<tr>
<td><br/></td>
</tr>
<tr>
<td>
<pre class="sourceHeading">            Line data    Source code</pre>
<pre class="source">
<span id="L1"><span class="lineNum">       1</span>              : //********************************************************************************</span>
<span id="L2"><span class="lineNum">       2</span>              : // SPDX-License-Identifier: Apache-2.0</span>
<span id="L3"><span class="lineNum">       3</span>              : // Copyright 2020 Western Digital Corporation or its affiliates.</span>
<span id="L4"><span class="lineNum">       4</span>              : //</span>
<span id="L5"><span class="lineNum">       5</span>              : // Licensed under the Apache License, Version 2.0 (the "License");</span>
<span id="L6"><span class="lineNum">       6</span>              : // you may not use this file except in compliance with the License.</span>
<span id="L7"><span class="lineNum">       7</span>              : // You may obtain a copy of the License at</span>
<span id="L8"><span class="lineNum">       8</span>              : //</span>
<span id="L9"><span class="lineNum">       9</span>              : // http://www.apache.org/licenses/LICENSE-2.0</span>
<span id="L10"><span class="lineNum">      10</span>              : //</span>
<span id="L11"><span class="lineNum">      11</span>              : // Unless required by applicable law or agreed to in writing, software</span>
<span id="L12"><span class="lineNum">      12</span>              : // distributed under the License is distributed on an "AS IS" BASIS,</span>
<span id="L13"><span class="lineNum">      13</span>              : // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span id="L14"><span class="lineNum">      14</span>              : // See the License for the specific language governing permissions and</span>
<span id="L15"><span class="lineNum">      15</span>              : // limitations under the License.</span>
<span id="L16"><span class="lineNum">      16</span>              : //********************************************************************************</span>
<span id="L17"><span class="lineNum">      17</span>              : </span>
<span id="L18"><span class="lineNum">      18</span>              : //********************************************************************************</span>
<span id="L19"><span class="lineNum">      19</span>              : // Function: Instruction aligner</span>
<span id="L20"><span class="lineNum">      20</span>              : //********************************************************************************</span>
<span id="L21"><span class="lineNum">      21</span>              : module el2_ifu_aln_ctl</span>
<span id="L22"><span class="lineNum">      22</span>              : import el2_pkg::*;</span>
<span id="L23"><span class="lineNum">      23</span>              : #(</span>
<span id="L24"><span class="lineNum">      24</span>              : `include "el2_param.vh"</span>
<span id="L25"><span class="lineNum">      25</span>              :  )</span>
<span id="L26"><span class="lineNum">      26</span>              :   (</span>
<span id="L27"><span class="lineNum">      27</span>              : </span>
<span id="L28"><span class="lineNum">      28</span>              :    // Excluding scan_mode from coverage as its usage is determined by the integrator of the VeeR core.</span>
<span id="L29"><span class="lineNum">      29</span>              :    /*verilator coverage_off*/</span>
<span id="L30"><span class="lineNum">      30</span>              :    input logic                                    scan_mode,                // Flop scan mode control</span>
<span id="L31"><span class="lineNum">      31</span>              :    /*verilator coverage_on*/</span>
<span id="L32"><span class="lineNum">      32</span> <span class="tlaGNC tlaBgGNC">           6 :    input logic                                    rst_l,                    // reset, active low</span></span>
<span id="L33"><span class="lineNum">      33</span> <span class="tlaGNC">       59176 :    input logic                                    clk,                      // Clock only while core active.  Through one clock header.  For flops with    second clock header built in.  Connected to ACTIVE_L2CLK.</span></span>
<span id="L34"><span class="lineNum">      34</span> <span class="tlaGNC">       59176 :    input logic                                    active_clk,               // Clock only while core active.  Through two clock headers. For flops without second clock header built in.</span></span>
<span id="L35"><span class="lineNum">      35</span>              : </span>
<span id="L36"><span class="lineNum">      36</span> <span class="tlaUNC tlaBgUNC">           0 :    input logic                                    ifu_async_error_start,    // ecc/parity related errors with current fetch - not sent down the pipe</span></span>
<span id="L37"><span class="lineNum">      37</span>              : </span>
<span id="L38"><span class="lineNum">      38</span> <span class="tlaUNC">           0 :    input logic [1:0]                              iccm_rd_ecc_double_err,   // This fetch has a double ICCM ecc  error.</span></span>
<span id="L39"><span class="lineNum">      39</span>              : </span>
<span id="L40"><span class="lineNum">      40</span> <span class="tlaGNC tlaBgGNC">          16 :    input logic [1:0]                              ic_access_fault_f,        // Instruction access fault for the current fetch.</span></span>
<span id="L41"><span class="lineNum">      41</span> <span class="tlaGNC">          16 :    input logic [1:0]                              ic_access_fault_type_f,   // Instruction access fault types</span></span>
<span id="L42"><span class="lineNum">      42</span>              : </span>
<span id="L43"><span class="lineNum">      43</span> <span class="tlaGNC">         700 :    input logic                                    exu_flush_final,          // Flush from the pipeline.</span></span>
<span id="L44"><span class="lineNum">      44</span>              : </span>
<span id="L45"><span class="lineNum">      45</span> <span class="tlaGNC">        9046 :    input logic                                    dec_i0_decode_d,          // Valid instruction at D-stage and not blocked</span></span>
<span id="L46"><span class="lineNum">      46</span>              : </span>
<span id="L47"><span class="lineNum">      47</span> <span class="tlaGNC">        3716 :    input logic [31:0]                             ifu_fetch_data_f,         // fetch data in memory format - not right justified</span></span>
<span id="L48"><span class="lineNum">      48</span>              : </span>
<span id="L49"><span class="lineNum">      49</span> <span class="tlaGNC">        8880 :    input logic [1:0]                              ifu_fetch_val,            // valids on a 2B boundary, right justified</span></span>
<span id="L50"><span class="lineNum">      50</span> <span class="tlaGNC">           6 :    input logic [31:1]                             ifu_fetch_pc,             // starting pc of fetch</span></span>
<span id="L51"><span class="lineNum">      51</span>              : </span>
<span id="L52"><span class="lineNum">      52</span>              : </span>
<span id="L53"><span class="lineNum">      53</span>              : </span>
<span id="L54"><span class="lineNum">      54</span> <span class="tlaGNC">        8962 :    output logic                                   ifu_i0_valid,             // Instruction 0 is valid</span></span>
<span id="L55"><span class="lineNum">      55</span> <span class="tlaGNC">          16 :    output logic                                   ifu_i0_icaf,              // Instruction 0 has access fault</span></span>
<span id="L56"><span class="lineNum">      56</span> <span class="tlaGNC">          16 :    output logic [1:0]                             ifu_i0_icaf_type,         // Instruction 0 access fault type</span></span>
<span id="L57"><span class="lineNum">      57</span> <span class="tlaGNC">           8 :    output logic                                   ifu_i0_icaf_second,       // Instruction 0 has access fault on second 2B of 4B inst</span></span>
<span id="L58"><span class="lineNum">      58</span>              : </span>
<span id="L59"><span class="lineNum">      59</span> <span class="tlaUNC tlaBgUNC">           0 :    output logic                                   ifu_i0_dbecc,             // Instruction 0 has double bit ecc error</span></span>
<span id="L60"><span class="lineNum">      60</span> <span class="tlaGNC tlaBgGNC">         292 :    output logic [31:0]                            ifu_i0_instr,             // Instruction 0</span></span>
<span id="L61"><span class="lineNum">      61</span> <span class="tlaGNC">          18 :    output logic [31:1]                            ifu_i0_pc,                // Instruction 0 PC</span></span>
<span id="L62"><span class="lineNum">      62</span> <span class="tlaGNC">        4782 :    output logic                                   ifu_i0_pc4,</span></span>
<span id="L63"><span class="lineNum">      63</span>              : </span>
<span id="L64"><span class="lineNum">      64</span> <span class="tlaGNC">        7510 :    output logic                                   ifu_fb_consume1,          // Consumed one buffer. To fetch control fetch for buffer mass balance</span></span>
<span id="L65"><span class="lineNum">      65</span> <span class="tlaGNC">          68 :    output logic                                   ifu_fb_consume2,          // Consumed two buffers.To fetch control fetch for buffer mass balance</span></span>
<span id="L66"><span class="lineNum">      66</span>              : </span>
<span id="L67"><span class="lineNum">      67</span>              : </span>
<span id="L68"><span class="lineNum">      68</span> <span class="tlaGNC">          14 :    input logic [pt.BHT_GHR_SIZE-1:0]              ifu_bp_fghr_f,            // fetch GHR</span></span>
<span id="L69"><span class="lineNum">      69</span> <span class="tlaGNC">          36 :    input logic [31:1]                             ifu_bp_btb_target_f,      // predicted RET target</span></span>
<span id="L70"><span class="lineNum">      70</span> <span class="tlaGNC">           6 :    input logic [11:0]                             ifu_bp_poffset_f,         // predicted target offset</span></span>
<span id="L71"><span class="lineNum">      71</span> <span class="tlaUNC tlaBgUNC">           0 :    input logic [1:0] [$clog2(pt.BTB_SIZE)-1:0]    ifu_bp_fa_index_f,        // predicted branch index (fully associative option)</span></span>
<span id="L72"><span class="lineNum">      72</span>              : </span>
<span id="L73"><span class="lineNum">      73</span> <span class="tlaGNC tlaBgGNC">          24 :    input logic [1:0]                              ifu_bp_hist0_f,           // history counters for all 4 potential branches, bit 1, right justified</span></span>
<span id="L74"><span class="lineNum">      74</span> <span class="tlaGNC">         414 :    input logic [1:0]                              ifu_bp_hist1_f,           // history counters for all 4 potential branches, bit 1, right justified</span></span>
<span id="L75"><span class="lineNum">      75</span> <span class="tlaGNC">          48 :    input logic [1:0]                              ifu_bp_pc4_f,             // pc4 indication, right justified</span></span>
<span id="L76"><span class="lineNum">      76</span> <span class="tlaGNC">         650 :    input logic [1:0]                              ifu_bp_way_f,             // way indication, right justified</span></span>
<span id="L77"><span class="lineNum">      77</span> <span class="tlaGNC">          78 :    input logic [1:0]                              ifu_bp_valid_f,           // branch valid, right justified</span></span>
<span id="L78"><span class="lineNum">      78</span> <span class="tlaUNC tlaBgUNC">           0 :    input logic [1:0]                              ifu_bp_ret_f,             // predicted ret indication, right justified</span></span>
<span id="L79"><span class="lineNum">      79</span>              : </span>
<span id="L80"><span class="lineNum">      80</span>              : </span>
<span id="L81"><span class="lineNum">      81</span> <span class="tlaGNC tlaBgGNC">         156 :    output el2_br_pkt_t                           i0_brp,                   // Branch packet for I0.</span></span>
<span id="L82"><span class="lineNum">      82</span> <span class="tlaGNC">         296 :    output logic [pt.BTB_ADDR_HI:pt.BTB_ADDR_LO]   ifu_i0_bp_index,          // BP index</span></span>
<span id="L83"><span class="lineNum">      83</span> <span class="tlaGNC">          54 :    output logic [pt.BHT_GHR_SIZE-1:0]             ifu_i0_bp_fghr,           // BP FGHR</span></span>
<span id="L84"><span class="lineNum">      84</span> <span class="tlaGNC">          40 :    output logic [pt.BTB_BTAG_SIZE-1:0]            ifu_i0_bp_btag,           // BP tag</span></span>
<span id="L85"><span class="lineNum">      85</span>              : </span>
<span id="L86"><span class="lineNum">      86</span> <span class="tlaUNC tlaBgUNC">           0 :    output logic [$clog2(pt.BTB_SIZE)-1:0]         ifu_i0_fa_index,          // Fully associt btb index</span></span>
<span id="L87"><span class="lineNum">      87</span>              : </span>
<span id="L88"><span class="lineNum">      88</span> <span class="tlaGNC tlaBgGNC">        9046 :    output logic                                   ifu_pmu_instr_aligned,    // number of inst aligned this cycle</span></span>
<span id="L89"><span class="lineNum">      89</span>              : </span>
<span id="L90"><span class="lineNum">      90</span> <span class="tlaGNC">        1380 :    output logic [15:0]                            ifu_i0_cinst              // 16b compress inst for i0</span></span>
<span id="L91"><span class="lineNum">      91</span>              :    );</span>
<span id="L92"><span class="lineNum">      92</span>              : </span>
<span id="L93"><span class="lineNum">      93</span>              : </span>
<span id="L94"><span class="lineNum">      94</span>              : </span>
<span id="L95"><span class="lineNum">      95</span> <span class="tlaGNC">        9100 :    logic                                          ifvalid;</span></span>
<span id="L96"><span class="lineNum">      96</span> <span class="tlaGNC">           4 :    logic                                          shift_f1_f0, shift_f2_f0, shift_f2_f1;</span></span>
<span id="L97"><span class="lineNum">      97</span> <span class="tlaGNC">           4 :    logic                                          fetch_to_f0, fetch_to_f1, fetch_to_f2;</span></span>
<span id="L98"><span class="lineNum">      98</span>              : </span>
<span id="L99"><span class="lineNum">      99</span> <span class="tlaGNC">           4 :    logic [1:0]                                    f2val_in, f2val;</span></span>
<span id="L100"><span class="lineNum">     100</span> <span class="tlaGNC">        3408 :    logic [1:0]                                    f1val_in, f1val;</span></span>
<span id="L101"><span class="lineNum">     101</span> <span class="tlaGNC">        5462 :    logic [1:0]                                    f0val_in, f0val;</span></span>
<span id="L102"><span class="lineNum">     102</span> <span class="tlaGNC">          12 :    logic [1:0]                                    sf1val, sf0val;</span></span>
<span id="L103"><span class="lineNum">     103</span>              : </span>
<span id="L104"><span class="lineNum">     104</span> <span class="tlaGNC">        1380 :    logic [31:0]                                   aligndata;</span></span>
<span id="L105"><span class="lineNum">     105</span> <span class="tlaGNC">        4782 :    logic                                          first4B, first2B;</span></span>
<span id="L106"><span class="lineNum">     106</span>              : </span>
<span id="L107"><span class="lineNum">     107</span> <span class="tlaGNC">          36 :    logic [31:0]                                   uncompress0;</span></span>
<span id="L108"><span class="lineNum">     108</span> <span class="tlaGNC">        9046 :    logic                                          i0_shift;</span></span>
<span id="L109"><span class="lineNum">     109</span> <span class="tlaGNC">        2612 :    logic                                          shift_2B, shift_4B;</span></span>
<span id="L110"><span class="lineNum">     110</span> <span class="tlaGNC">        3464 :    logic                                          f1_shift_2B;</span></span>
<span id="L111"><span class="lineNum">     111</span> <span class="tlaGNC">           4 :    logic                                          f2_valid, sf1_valid, sf0_valid;</span></span>
<span id="L112"><span class="lineNum">     112</span>              : </span>
<span id="L113"><span class="lineNum">     113</span> <span class="tlaGNC">        1380 :    logic [31:0]                                   ifirst;</span></span>
<span id="L114"><span class="lineNum">     114</span> <span class="tlaGNC">        5598 :    logic [1:0]                                    alignval;</span></span>
<span id="L115"><span class="lineNum">     115</span> <span class="tlaGNC">        2612 :    logic [31:1]                                   firstpc, secondpc;</span></span>
<span id="L116"><span class="lineNum">     116</span>              : </span>
<span id="L117"><span class="lineNum">     117</span> <span class="tlaUNC tlaBgUNC">           0 :    logic [11:0]                                   f1poffset;</span></span>
<span id="L118"><span class="lineNum">     118</span> <span class="tlaUNC">           0 :    logic [11:0]                                   f0poffset;</span></span>
<span id="L119"><span class="lineNum">     119</span> <span class="tlaGNC tlaBgGNC">          10 :    logic [pt.BHT_GHR_SIZE-1:0]                    f1fghr;</span></span>
<span id="L120"><span class="lineNum">     120</span> <span class="tlaGNC">          38 :    logic [pt.BHT_GHR_SIZE-1:0]                    f0fghr;</span></span>
<span id="L121"><span class="lineNum">     121</span> <span class="tlaGNC">         328 :    logic [1:0]                                    f1hist1;</span></span>
<span id="L122"><span class="lineNum">     122</span> <span class="tlaGNC">         428 :    logic [1:0]                                    f0hist1;</span></span>
<span id="L123"><span class="lineNum">     123</span> <span class="tlaGNC">          28 :    logic [1:0]                                    f1hist0;</span></span>
<span id="L124"><span class="lineNum">     124</span> <span class="tlaGNC">          40 :    logic [1:0]                                    f0hist0;</span></span>
<span id="L125"><span class="lineNum">     125</span>              : </span>
<span id="L126"><span class="lineNum">     126</span> <span class="tlaUNC tlaBgUNC">           0 :    logic [1:0][$clog2(pt.BTB_SIZE)-1:0]           f0index, f1index, alignindex;</span></span>
<span id="L127"><span class="lineNum">     127</span>              : </span>
<span id="L128"><span class="lineNum">     128</span> <span class="tlaGNC tlaBgGNC">           8 :    logic [1:0]                                    f1ictype;</span></span>
<span id="L129"><span class="lineNum">     129</span> <span class="tlaGNC">           8 :    logic [1:0]                                    f0ictype;</span></span>
<span id="L130"><span class="lineNum">     130</span>              : </span>
<span id="L131"><span class="lineNum">     131</span> <span class="tlaGNC">          48 :    logic [1:0]                                    f1pc4;</span></span>
<span id="L132"><span class="lineNum">     132</span> <span class="tlaGNC">          48 :    logic [1:0]                                    f0pc4;</span></span>
<span id="L133"><span class="lineNum">     133</span>              : </span>
<span id="L134"><span class="lineNum">     134</span> <span class="tlaUNC tlaBgUNC">           0 :    logic [1:0]                                    f1ret;</span></span>
<span id="L135"><span class="lineNum">     135</span> <span class="tlaUNC">           0 :    logic [1:0]                                    f0ret;</span></span>
<span id="L136"><span class="lineNum">     136</span> <span class="tlaGNC tlaBgGNC">         448 :    logic [1:0]                                    f1way;</span></span>
<span id="L137"><span class="lineNum">     137</span> <span class="tlaGNC">         532 :    logic [1:0]                                    f0way;</span></span>
<span id="L138"><span class="lineNum">     138</span>              : </span>
<span id="L139"><span class="lineNum">     139</span> <span class="tlaGNC">          56 :    logic [1:0]                                    f1brend;</span></span>
<span id="L140"><span class="lineNum">     140</span> <span class="tlaGNC">          80 :    logic [1:0]                                    f0brend;</span></span>
<span id="L141"><span class="lineNum">     141</span>              : </span>
<span id="L142"><span class="lineNum">     142</span> <span class="tlaGNC">          64 :    logic [1:0]                                    alignbrend;</span></span>
<span id="L143"><span class="lineNum">     143</span> <span class="tlaGNC">          24 :    logic [1:0]                                    alignpc4;</span></span>
<span id="L144"><span class="lineNum">     144</span>              : </span>
<span id="L145"><span class="lineNum">     145</span> <span class="tlaUNC tlaBgUNC">           0 :    logic [1:0]                                    alignret;</span></span>
<span id="L146"><span class="lineNum">     146</span> <span class="tlaGNC tlaBgGNC">         668 :    logic [1:0]                                    alignway;</span></span>
<span id="L147"><span class="lineNum">     147</span> <span class="tlaGNC">         488 :    logic [1:0]                                    alignhist1;</span></span>
<span id="L148"><span class="lineNum">     148</span> <span class="tlaGNC">          56 :    logic [1:0]                                    alignhist0;</span></span>
<span id="L149"><span class="lineNum">     149</span> <span class="tlaGNC">        1832 :    logic [1:1]                                    alignfromf1;</span></span>
<span id="L150"><span class="lineNum">     150</span> <span class="tlaGNC">        1080 :    logic                                          i0_ends_f1;</span></span>
<span id="L151"><span class="lineNum">     151</span> <span class="tlaGNC">           4 :    logic                                          i0_br_start_error;</span></span>
<span id="L152"><span class="lineNum">     152</span>              : </span>
<span id="L153"><span class="lineNum">     153</span> <span class="tlaGNC">          20 :    logic [31:1]                                   f1prett;</span></span>
<span id="L154"><span class="lineNum">     154</span> <span class="tlaGNC">          12 :    logic [31:1]                                   f0prett;</span></span>
<span id="L155"><span class="lineNum">     155</span> <span class="tlaUNC tlaBgUNC">           0 :    logic [1:0]                                    f1dbecc;</span></span>
<span id="L156"><span class="lineNum">     156</span> <span class="tlaUNC">           0 :    logic [1:0]                                    f0dbecc;</span></span>
<span id="L157"><span class="lineNum">     157</span> <span class="tlaGNC tlaBgGNC">           8 :    logic [1:0]                                    f1icaf;</span></span>
<span id="L158"><span class="lineNum">     158</span> <span class="tlaGNC">           8 :    logic [1:0]                                    f0icaf;</span></span>
<span id="L159"><span class="lineNum">     159</span>              : </span>
<span id="L160"><span class="lineNum">     160</span> <span class="tlaUNC tlaBgUNC">           0 :    logic [1:0]                                    aligndbecc;</span></span>
<span id="L161"><span class="lineNum">     161</span> <span class="tlaGNC tlaBgGNC">           8 :    logic [1:0]                                    alignicaf;</span></span>
<span id="L162"><span class="lineNum">     162</span> <span class="tlaGNC">         104 :    logic                                          i0_brp_pc4;</span></span>
<span id="L163"><span class="lineNum">     163</span>              : </span>
<span id="L164"><span class="lineNum">     164</span> <span class="tlaGNC">         204 :    logic [pt.BTB_ADDR_HI:pt.BTB_ADDR_LO]          firstpc_hash, secondpc_hash;</span></span>
<span id="L165"><span class="lineNum">     165</span>              : </span>
<span id="L166"><span class="lineNum">     166</span> <span class="tlaUNC tlaBgUNC">           0 :    logic                                          first_legal;</span></span>
<span id="L167"><span class="lineNum">     167</span>              : </span>
<span id="L168"><span class="lineNum">     168</span> <span class="tlaGNC tlaBgGNC">        3014 :    logic [1:0]                                    wrptr, wrptr_in;</span></span>
<span id="L169"><span class="lineNum">     169</span> <span class="tlaGNC">        2784 :    logic [1:0]                                    rdptr, rdptr_in;</span></span>
<span id="L170"><span class="lineNum">     170</span> <span class="tlaGNC">        2808 :    logic [2:0]                                    qwen;</span></span>
<span id="L171"><span class="lineNum">     171</span> <span class="tlaGNC">         394 :    logic [31:0]                                   q2,q1,q0;</span></span>
<span id="L172"><span class="lineNum">     172</span> <span class="tlaGNC">        1690 :    logic                                          q2off_in, q2off;</span></span>
<span id="L173"><span class="lineNum">     173</span> <span class="tlaGNC">        1776 :    logic                                          q1off_in, q1off;</span></span>
<span id="L174"><span class="lineNum">     174</span> <span class="tlaGNC">        1904 :    logic                                          q0off_in, q0off;</span></span>
<span id="L175"><span class="lineNum">     175</span> <span class="tlaGNC">        5360 :    logic                                          f0_shift_2B;</span></span>
<span id="L176"><span class="lineNum">     176</span>              : </span>
<span id="L177"><span class="lineNum">     177</span> <span class="tlaGNC">        1914 :    logic [31:0]                                   q0eff;</span></span>
<span id="L178"><span class="lineNum">     178</span> <span class="tlaGNC">         850 :    logic [31:0]                                   q0final;</span></span>
<span id="L179"><span class="lineNum">     179</span> <span class="tlaGNC">        3284 :    logic                                          q0ptr;</span></span>
<span id="L180"><span class="lineNum">     180</span> <span class="tlaGNC">        3284 :    logic [1:0]                                    q0sel;</span></span>
<span id="L181"><span class="lineNum">     181</span>              : </span>
<span id="L182"><span class="lineNum">     182</span> <span class="tlaGNC">        1426 :    logic [31:0]                                   q1eff;</span></span>
<span id="L183"><span class="lineNum">     183</span> <span class="tlaGNC">        1858 :    logic [15:0]                                   q1final;</span></span>
<span id="L184"><span class="lineNum">     184</span> <span class="tlaGNC">        3422 :    logic                                          q1ptr;</span></span>
<span id="L185"><span class="lineNum">     185</span> <span class="tlaGNC">        3422 :    logic [1:0]                                    q1sel;</span></span>
<span id="L186"><span class="lineNum">     186</span>              : </span>
<span id="L187"><span class="lineNum">     187</span> <span class="tlaGNC">        2784 :    logic [2:0]                                    qren;</span></span>
<span id="L188"><span class="lineNum">     188</span>              : </span>
<span id="L189"><span class="lineNum">     189</span> <span class="tlaGNC">          68 :    logic                                          consume_fb1, consume_fb0;</span></span>
<span id="L190"><span class="lineNum">     190</span> <span class="tlaGNC">           8 :    logic [1:0]                                    icaf_eff;</span></span>
<span id="L191"><span class="lineNum">     191</span>              : </span>
<span id="L192"><span class="lineNum">     192</span>              :    localparam                                     BRDATA_SIZE  = pt.BTB_ENABLE ? 16+($clog2(pt.BTB_SIZE)*2*pt.BTB_FULLYA) : 4;</span>
<span id="L193"><span class="lineNum">     193</span>              :    localparam                                     BRDATA_WIDTH = pt.BTB_ENABLE ? 8+($clog2(pt.BTB_SIZE)*pt.BTB_FULLYA) : 2;</span>
<span id="L194"><span class="lineNum">     194</span> <span class="tlaGNC">          28 :    logic [BRDATA_SIZE-1:0]                        brdata_in, brdata2, brdata1, brdata0;</span></span>
<span id="L195"><span class="lineNum">     195</span> <span class="tlaGNC">         132 :    logic [BRDATA_SIZE-1:0]                        brdata1eff, brdata0eff;</span></span>
<span id="L196"><span class="lineNum">     196</span> <span class="tlaGNC">          80 :    logic [BRDATA_SIZE-1:0]                        brdata1final, brdata0final;</span></span>
<span id="L197"><span class="lineNum">     197</span>              : </span>
<span id="L198"><span class="lineNum">     198</span>              :    localparam                                     MHI   = 1+(pt.BTB_ENABLE * (43+pt.BHT_GHR_SIZE));</span>
<span id="L199"><span class="lineNum">     199</span>              :    localparam                                     MSIZE = 2+(pt.BTB_ENABLE * (43+pt.BHT_GHR_SIZE));</span>
<span id="L200"><span class="lineNum">     200</span>              : </span>
<span id="L201"><span class="lineNum">     201</span> <span class="tlaGNC">           8 :    logic [MHI:0]                                  misc_data_in, misc2, misc1, misc0;</span></span>
<span id="L202"><span class="lineNum">     202</span> <span class="tlaGNC">           8 :    logic [MHI:0]                                  misc1eff, misc0eff;</span></span>
<span id="L203"><span class="lineNum">     203</span>              : </span>
<span id="L204"><span class="lineNum">     204</span> <span class="tlaGNC">          36 :    logic [pt.BTB_BTAG_SIZE-1:0]                  firstbrtag_hash, secondbrtag_hash;</span></span>
<span id="L205"><span class="lineNum">     205</span>              : </span>
<span id="L206"><span class="lineNum">     206</span> <span class="tlaUNC tlaBgUNC">           0 :    logic                                         error_stall_in, error_stall;</span></span>
<span id="L207"><span class="lineNum">     207</span>              : </span>
<span id="L208"><span class="lineNum">     208</span>              :    assign error_stall_in = (error_stall | ifu_async_error_start) &amp; ~exu_flush_final;</span>
<span id="L209"><span class="lineNum">     209</span>              : </span>
<span id="L210"><span class="lineNum">     210</span>              :    rvdff #(.WIDTH(7))  bundle1ff (.*,</span>
<span id="L211"><span class="lineNum">     211</span>              :                                   .clk(active_clk),</span>
<span id="L212"><span class="lineNum">     212</span>              :                                   .din ({wrptr_in[1:0],rdptr_in[1:0],q2off_in,q1off_in,q0off_in}),</span>
<span id="L213"><span class="lineNum">     213</span>              :                                   .dout({wrptr[1:0],   rdptr[1:0],   q2off,   q1off,   q0off})</span>
<span id="L214"><span class="lineNum">     214</span>              :                                   );</span>
<span id="L215"><span class="lineNum">     215</span>              : </span>
<span id="L216"><span class="lineNum">     216</span>              :    rvdffie #(.WIDTH(7),.OVERRIDE(1))  bundle2ff (.*,</span>
<span id="L217"><span class="lineNum">     217</span>              :                                                  .din ({error_stall_in,f2val_in[1:0],f1val_in[1:0],f0val_in[1:0]}),</span>
<span id="L218"><span class="lineNum">     218</span>              :                                                  .dout({error_stall,   f2val[1:0],   f1val[1:0],   f0val[1:0]   })</span>
<span id="L219"><span class="lineNum">     219</span>              :                                                  );</span>
<span id="L220"><span class="lineNum">     220</span>              : </span>
<span id="L221"><span class="lineNum">     221</span>              : if(pt.BTB_ENABLE==1) begin : genblock1</span>
<span id="L222"><span class="lineNum">     222</span>              :    rvdffe #(BRDATA_SIZE)  brdata2ff   (.*, .clk(clk), .en(qwen[2]),        .din(brdata_in[BRDATA_SIZE-1:0]), .dout(brdata2[BRDATA_SIZE-1:0]));</span>
<span id="L223"><span class="lineNum">     223</span>              :    rvdffe #(BRDATA_SIZE)  brdata1ff   (.*, .clk(clk), .en(qwen[1]),        .din(brdata_in[BRDATA_SIZE-1:0]), .dout(brdata1[BRDATA_SIZE-1:0]));</span>
<span id="L224"><span class="lineNum">     224</span>              :    rvdffe #(BRDATA_SIZE)  brdata0ff   (.*, .clk(clk), .en(qwen[0]),        .din(brdata_in[BRDATA_SIZE-1:0]), .dout(brdata0[BRDATA_SIZE-1:0]));</span>
<span id="L225"><span class="lineNum">     225</span>              :    rvdffe #(MSIZE)        misc2ff     (.*, .clk(clk), .en(qwen[2]),        .din(misc_data_in[MHI:0]),        .dout(misc2[MHI:0]));</span>
<span id="L226"><span class="lineNum">     226</span>              :    rvdffe #(MSIZE)        misc1ff     (.*, .clk(clk), .en(qwen[1]),        .din(misc_data_in[MHI:0]),        .dout(misc1[MHI:0]));</span>
<span id="L227"><span class="lineNum">     227</span>              :    rvdffe #(MSIZE)        misc0ff     (.*, .clk(clk), .en(qwen[0]),        .din(misc_data_in[MHI:0]),        .dout(misc0[MHI:0]));</span>
<span id="L228"><span class="lineNum">     228</span>              : end</span>
<span id="L229"><span class="lineNum">     229</span>              : else begin : genblock1</span>
<span id="L230"><span class="lineNum">     230</span>              : </span>
<span id="L231"><span class="lineNum">     231</span>              :    rvdffie #((MSIZE*3)+(BRDATA_SIZE*3))    miscff      (.*,</span>
<span id="L232"><span class="lineNum">     232</span>              :                                                         .din({qwen[2] ? {misc_data_in[MHI:0], brdata_in[BRDATA_SIZE-1:0]} : {misc2[MHI:0], brdata2[BRDATA_SIZE-1:0]},</span>
<span id="L233"><span class="lineNum">     233</span>              :                                                               qwen[1] ? {misc_data_in[MHI:0], brdata_in[BRDATA_SIZE-1:0]} : {misc1[MHI:0], brdata1[BRDATA_SIZE-1:0]},</span>
<span id="L234"><span class="lineNum">     234</span>              :                                                               qwen[0] ? {misc_data_in[MHI:0], brdata_in[BRDATA_SIZE-1:0]} : {misc0[MHI:0], brdata0[BRDATA_SIZE-1:0]}}),</span>
<span id="L235"><span class="lineNum">     235</span>              :                                                         .dout({misc2[MHI:0], brdata2[BRDATA_SIZE-1:0],</span>
<span id="L236"><span class="lineNum">     236</span>              :                                                                misc1[MHI:0], brdata1[BRDATA_SIZE-1:0],</span>
<span id="L237"><span class="lineNum">     237</span>              :                                                                misc0[MHI:0], brdata0[BRDATA_SIZE-1:0]})</span>
<span id="L238"><span class="lineNum">     238</span>              :                                                         );</span>
<span id="L239"><span class="lineNum">     239</span>              : end</span>
<span id="L240"><span class="lineNum">     240</span>              : </span>
<span id="L241"><span class="lineNum">     241</span> <span class="tlaGNC tlaBgGNC">           6 :   logic [31:1] q2pc, q1pc, q0pc;</span></span>
<span id="L242"><span class="lineNum">     242</span>              : </span>
<span id="L243"><span class="lineNum">     243</span>              :    rvdffe #(31)           q2pcff        (.*, .clk(clk), .en(qwen[2]),        .din(ifu_fetch_pc[31:1]),     .dout(q2pc[31:1]));</span>
<span id="L244"><span class="lineNum">     244</span>              :    rvdffe #(31)           q1pcff        (.*, .clk(clk), .en(qwen[1]),        .din(ifu_fetch_pc[31:1]),     .dout(q1pc[31:1]));</span>
<span id="L245"><span class="lineNum">     245</span>              :    rvdffe #(31)           q0pcff        (.*, .clk(clk), .en(qwen[0]),        .din(ifu_fetch_pc[31:1]),     .dout(q0pc[31:1]));</span>
<span id="L246"><span class="lineNum">     246</span>              : </span>
<span id="L247"><span class="lineNum">     247</span>              :    rvdffe #(32)           q2ff        (.*, .clk(clk), .en(qwen[2]),        .din(ifu_fetch_data_f[31:0]),     .dout(q2[31:0]));</span>
<span id="L248"><span class="lineNum">     248</span>              :    rvdffe #(32)           q1ff        (.*, .clk(clk), .en(qwen[1]),        .din(ifu_fetch_data_f[31:0]),     .dout(q1[31:0]));</span>
<span id="L249"><span class="lineNum">     249</span>              :    rvdffe #(32)           q0ff        (.*, .clk(clk), .en(qwen[0]),        .din(ifu_fetch_data_f[31:0]),     .dout(q0[31:0]));</span>
<span id="L250"><span class="lineNum">     250</span>              : </span>
<span id="L251"><span class="lineNum">     251</span>              : </span>
<span id="L252"><span class="lineNum">     252</span>              :    // new queue control logic</span>
<span id="L253"><span class="lineNum">     253</span>              : </span>
<span id="L254"><span class="lineNum">     254</span>              :    assign qren[2:0]          = {  rdptr[1:0] == 2'b10,</span>
<span id="L255"><span class="lineNum">     255</span>              :                                   rdptr[1:0] == 2'b01,</span>
<span id="L256"><span class="lineNum">     256</span>              :                                   rdptr[1:0] == 2'b00 };</span>
<span id="L257"><span class="lineNum">     257</span>              : </span>
<span id="L258"><span class="lineNum">     258</span>              :    assign qwen[2:0]          = { (wrptr[1:0] == 2'b10) &amp; ifvalid,</span>
<span id="L259"><span class="lineNum">     259</span>              :                                  (wrptr[1:0] == 2'b01) &amp; ifvalid,</span>
<span id="L260"><span class="lineNum">     260</span>              :                                  (wrptr[1:0] == 2'b00) &amp; ifvalid };</span>
<span id="L261"><span class="lineNum">     261</span>              : </span>
<span id="L262"><span class="lineNum">     262</span>              : </span>
<span id="L263"><span class="lineNum">     263</span>              :    assign rdptr_in[1:0]      = ({2{ qren[0]         &amp;  ifu_fb_consume1 &amp; ~exu_flush_final}} &amp; 2'b01     ) |</span>
<span id="L264"><span class="lineNum">     264</span>              :                                ({2{ qren[1]         &amp;  ifu_fb_consume1 &amp; ~exu_flush_final}} &amp; 2'b10     ) |</span>
<span id="L265"><span class="lineNum">     265</span>              :                                ({2{ qren[2]         &amp;  ifu_fb_consume1 &amp; ~exu_flush_final}} &amp; 2'b00     ) |</span>
<span id="L266"><span class="lineNum">     266</span>              :                                ({2{ qren[0]         &amp;  ifu_fb_consume2 &amp; ~exu_flush_final}} &amp; 2'b10     ) |</span>
<span id="L267"><span class="lineNum">     267</span>              :                                ({2{ qren[1]         &amp;  ifu_fb_consume2 &amp; ~exu_flush_final}} &amp; 2'b00     ) |</span>
<span id="L268"><span class="lineNum">     268</span>              :                                ({2{ qren[2]         &amp;  ifu_fb_consume2 &amp; ~exu_flush_final}} &amp; 2'b01     ) |</span>
<span id="L269"><span class="lineNum">     269</span>              :                                ({2{~ifu_fb_consume1 &amp; ~ifu_fb_consume2 &amp; ~exu_flush_final}} &amp; rdptr[1:0]);</span>
<span id="L270"><span class="lineNum">     270</span>              : </span>
<span id="L271"><span class="lineNum">     271</span>              :    assign wrptr_in[1:0]      = ({2{ qwen[0] &amp; ~exu_flush_final}} &amp; 2'b01     ) |</span>
<span id="L272"><span class="lineNum">     272</span>              :                                ({2{ qwen[1] &amp; ~exu_flush_final}} &amp; 2'b10     ) |</span>
<span id="L273"><span class="lineNum">     273</span>              :                                ({2{ qwen[2] &amp; ~exu_flush_final}} &amp; 2'b00     ) |</span>
<span id="L274"><span class="lineNum">     274</span>              :                                ({2{~ifvalid &amp; ~exu_flush_final}} &amp; wrptr[1:0]);</span>
<span id="L275"><span class="lineNum">     275</span>              : </span>
<span id="L276"><span class="lineNum">     276</span>              : </span>
<span id="L277"><span class="lineNum">     277</span>              : </span>
<span id="L278"><span class="lineNum">     278</span>              :    assign q2off_in          = ( ~qwen[2] &amp; (rdptr[1:0]==2'd2)  &amp;  (q2off | f0_shift_2B) ) |</span>
<span id="L279"><span class="lineNum">     279</span>              :                               ( ~qwen[2] &amp; (rdptr[1:0]==2'd1)  &amp;  (q2off | f1_shift_2B) ) |</span>
<span id="L280"><span class="lineNum">     280</span>              :                               ( ~qwen[2] &amp; (rdptr[1:0]==2'd0)  &amp;   q2off                );</span>
<span id="L281"><span class="lineNum">     281</span>              : </span>
<span id="L282"><span class="lineNum">     282</span>              :    assign q1off_in          = ( ~qwen[1] &amp; (rdptr[1:0]==2'd1)  &amp;  (q1off | f0_shift_2B) ) |</span>
<span id="L283"><span class="lineNum">     283</span>              :                               ( ~qwen[1] &amp; (rdptr[1:0]==2'd0)  &amp;  (q1off | f1_shift_2B) ) |</span>
<span id="L284"><span class="lineNum">     284</span>              :                               ( ~qwen[1] &amp; (rdptr[1:0]==2'd2)  &amp;   q1off                );</span>
<span id="L285"><span class="lineNum">     285</span>              : </span>
<span id="L286"><span class="lineNum">     286</span>              :    assign q0off_in          = ( ~qwen[0] &amp; (rdptr[1:0]==2'd0)  &amp;  (q0off | f0_shift_2B) ) |</span>
<span id="L287"><span class="lineNum">     287</span>              :                               ( ~qwen[0] &amp; (rdptr[1:0]==2'd2)  &amp;  (q0off | f1_shift_2B) ) |</span>
<span id="L288"><span class="lineNum">     288</span>              :                               ( ~qwen[0] &amp; (rdptr[1:0]==2'd1)  &amp;   q0off                );</span>
<span id="L289"><span class="lineNum">     289</span>              : </span>
<span id="L290"><span class="lineNum">     290</span>              : </span>
<span id="L291"><span class="lineNum">     291</span>              : </span>
<span id="L292"><span class="lineNum">     292</span>              :    assign q0ptr              = ( (rdptr[1:0]==2'b00) &amp; q0off ) |</span>
<span id="L293"><span class="lineNum">     293</span>              :                                ( (rdptr[1:0]==2'b01) &amp; q1off ) |</span>
<span id="L294"><span class="lineNum">     294</span>              :                                ( (rdptr[1:0]==2'b10) &amp; q2off );</span>
<span id="L295"><span class="lineNum">     295</span>              : </span>
<span id="L296"><span class="lineNum">     296</span>              :    assign q1ptr              = ( (rdptr[1:0]==2'b00) &amp; q1off ) |</span>
<span id="L297"><span class="lineNum">     297</span>              :                                ( (rdptr[1:0]==2'b01) &amp; q2off ) |</span>
<span id="L298"><span class="lineNum">     298</span>              :                                ( (rdptr[1:0]==2'b10) &amp; q0off );</span>
<span id="L299"><span class="lineNum">     299</span>              : </span>
<span id="L300"><span class="lineNum">     300</span>              :    assign q0sel[1:0]         = {q0ptr,~q0ptr};</span>
<span id="L301"><span class="lineNum">     301</span>              : </span>
<span id="L302"><span class="lineNum">     302</span>              :    assign q1sel[1:0]         = {q1ptr,~q1ptr};</span>
<span id="L303"><span class="lineNum">     303</span>              : </span>
<span id="L304"><span class="lineNum">     304</span>              :    // end new queue control logic</span>
<span id="L305"><span class="lineNum">     305</span>              : </span>
<span id="L306"><span class="lineNum">     306</span>              : </span>
<span id="L307"><span class="lineNum">     307</span>              :    // misc data that is associated with each fetch buffer</span>
<span id="L308"><span class="lineNum">     308</span>              : </span>
<span id="L309"><span class="lineNum">     309</span>              :    if(pt.BTB_ENABLE==1)</span>
<span id="L310"><span class="lineNum">     310</span>              :      assign misc_data_in[MHI:0] = {</span>
<span id="L311"><span class="lineNum">     311</span>              : </span>
<span id="L312"><span class="lineNum">     312</span>              :                                     ic_access_fault_type_f[1:0],</span>
<span id="L313"><span class="lineNum">     313</span>              :                                     ifu_bp_btb_target_f[31:1],</span>
<span id="L314"><span class="lineNum">     314</span>              :                                     ifu_bp_poffset_f[11:0],</span>
<span id="L315"><span class="lineNum">     315</span>              :                                     ifu_bp_fghr_f[pt.BHT_GHR_SIZE-1:0]</span>
<span id="L316"><span class="lineNum">     316</span>              :                                     };</span>
<span id="L317"><span class="lineNum">     317</span>              :    else</span>
<span id="L318"><span class="lineNum">     318</span>              :      assign misc_data_in[MHI:0] = {</span>
<span id="L319"><span class="lineNum">     319</span>              :                                     ic_access_fault_type_f[1:0]</span>
<span id="L320"><span class="lineNum">     320</span>              :                                     };</span>
<span id="L321"><span class="lineNum">     321</span>              : </span>
<span id="L322"><span class="lineNum">     322</span>              : </span>
<span id="L323"><span class="lineNum">     323</span>              :    assign {misc1eff[MHI:0],misc0eff[MHI:0]} = (({MSIZE*2{qren[0]}} &amp; {misc1[MHI:0],misc0[MHI:0]}) |</span>
<span id="L324"><span class="lineNum">     324</span>              :                                                ({MSIZE*2{qren[1]}} &amp; {misc2[MHI:0],misc1[MHI:0]}) |</span>
<span id="L325"><span class="lineNum">     325</span>              :                                                ({MSIZE*2{qren[2]}} &amp; {misc0[MHI:0],misc2[MHI:0]}));</span>
<span id="L326"><span class="lineNum">     326</span>              : </span>
<span id="L327"><span class="lineNum">     327</span>              :    if(pt.BTB_ENABLE==1) begin</span>
<span id="L328"><span class="lineNum">     328</span>              :    assign {</span>
<span id="L329"><span class="lineNum">     329</span>              :             f1ictype[1:0],</span>
<span id="L330"><span class="lineNum">     330</span>              :             f1prett[31:1],</span>
<span id="L331"><span class="lineNum">     331</span>              :             f1poffset[11:0],</span>
<span id="L332"><span class="lineNum">     332</span>              :             f1fghr[pt.BHT_GHR_SIZE-1:0]</span>
<span id="L333"><span class="lineNum">     333</span>              :             } = misc1eff[MHI:0];</span>
<span id="L334"><span class="lineNum">     334</span>              : </span>
<span id="L335"><span class="lineNum">     335</span>              :    assign {</span>
<span id="L336"><span class="lineNum">     336</span>              :             f0ictype[1:0],</span>
<span id="L337"><span class="lineNum">     337</span>              :             f0prett[31:1],</span>
<span id="L338"><span class="lineNum">     338</span>              :             f0poffset[11:0],</span>
<span id="L339"><span class="lineNum">     339</span>              :             f0fghr[pt.BHT_GHR_SIZE-1:0]</span>
<span id="L340"><span class="lineNum">     340</span>              :             } = misc0eff[MHI:0];</span>
<span id="L341"><span class="lineNum">     341</span>              : </span>
<span id="L342"><span class="lineNum">     342</span>              :       if(pt.BTB_FULLYA) begin</span>
<span id="L343"><span class="lineNum">     343</span>              :          assign brdata_in[BRDATA_SIZE-1:0] = {</span>
<span id="L344"><span class="lineNum">     344</span>              :                                                ifu_bp_fa_index_f[1], iccm_rd_ecc_double_err[1],ic_access_fault_f[1],ifu_bp_hist1_f[1],ifu_bp_hist0_f[1],ifu_bp_pc4_f[1],ifu_bp_way_f[1],ifu_bp_valid_f[1],ifu_bp_ret_f[1],</span>
<span id="L345"><span class="lineNum">     345</span>              :                                                ifu_bp_fa_index_f[0], iccm_rd_ecc_double_err[0],ic_access_fault_f[0],ifu_bp_hist1_f[0],ifu_bp_hist0_f[0],ifu_bp_pc4_f[0],ifu_bp_way_f[0],ifu_bp_valid_f[0],ifu_bp_ret_f[0]</span>
<span id="L346"><span class="lineNum">     346</span>              :                                                };</span>
<span id="L347"><span class="lineNum">     347</span>              :          assign {f0index[1],f0dbecc[1],f0icaf[1],f0hist1[1],f0hist0[1],f0pc4[1],f0way[1],f0brend[1],f0ret[1],</span>
<span id="L348"><span class="lineNum">     348</span>              :                  f0index[0],f0dbecc[0],f0icaf[0],f0hist1[0],f0hist0[0],f0pc4[0],f0way[0],f0brend[0],f0ret[0]} = brdata0final[BRDATA_SIZE-1:0];</span>
<span id="L349"><span class="lineNum">     349</span>              : </span>
<span id="L350"><span class="lineNum">     350</span>              :          assign {f1index[1],f1dbecc[1],f1icaf[1],f1hist1[1],f1hist0[1],f1pc4[1],f1way[1],f1brend[1],f1ret[1],</span>
<span id="L351"><span class="lineNum">     351</span>              :                  f1index[0],f1dbecc[0],f1icaf[0],f1hist1[0],f1hist0[0],f1pc4[0],f1way[0],f1brend[0],f1ret[0]} = brdata1final[BRDATA_SIZE-1:0];</span>
<span id="L352"><span class="lineNum">     352</span>              : </span>
<span id="L353"><span class="lineNum">     353</span>              :       end</span>
<span id="L354"><span class="lineNum">     354</span>              :       else begin</span>
<span id="L355"><span class="lineNum">     355</span>              :          assign brdata_in[BRDATA_SIZE-1:0] = {</span>
<span id="L356"><span class="lineNum">     356</span>              :                                                iccm_rd_ecc_double_err[1],ic_access_fault_f[1],ifu_bp_hist1_f[1],ifu_bp_hist0_f[1],ifu_bp_pc4_f[1],ifu_bp_way_f[1],ifu_bp_valid_f[1],ifu_bp_ret_f[1],</span>
<span id="L357"><span class="lineNum">     357</span>              :                                                iccm_rd_ecc_double_err[0],ic_access_fault_f[0],ifu_bp_hist1_f[0],ifu_bp_hist0_f[0],ifu_bp_pc4_f[0],ifu_bp_way_f[0],ifu_bp_valid_f[0],ifu_bp_ret_f[0]</span>
<span id="L358"><span class="lineNum">     358</span>              :                                                };</span>
<span id="L359"><span class="lineNum">     359</span>              :          assign {f0dbecc[1],f0icaf[1],f0hist1[1],f0hist0[1],f0pc4[1],f0way[1],f0brend[1],f0ret[1],</span>
<span id="L360"><span class="lineNum">     360</span>              :                  f0dbecc[0],f0icaf[0],f0hist1[0],f0hist0[0],f0pc4[0],f0way[0],f0brend[0],f0ret[0]} = brdata0final[BRDATA_SIZE-1:0];</span>
<span id="L361"><span class="lineNum">     361</span>              : </span>
<span id="L362"><span class="lineNum">     362</span>              :          assign {f1dbecc[1],f1icaf[1],f1hist1[1],f1hist0[1],f1pc4[1],f1way[1],f1brend[1],f1ret[1],</span>
<span id="L363"><span class="lineNum">     363</span>              :                  f1dbecc[0],f1icaf[0],f1hist1[0],f1hist0[0],f1pc4[0],f1way[0],f1brend[0],f1ret[0]} = brdata1final[BRDATA_SIZE-1:0];</span>
<span id="L364"><span class="lineNum">     364</span>              : </span>
<span id="L365"><span class="lineNum">     365</span>              :       end</span>
<span id="L366"><span class="lineNum">     366</span>              : </span>
<span id="L367"><span class="lineNum">     367</span>              : </span>
<span id="L368"><span class="lineNum">     368</span>              : </span>
<span id="L369"><span class="lineNum">     369</span>              : </span>
<span id="L370"><span class="lineNum">     370</span>              :    assign {brdata1eff[BRDATA_SIZE-1:0],brdata0eff[BRDATA_SIZE-1:0]} = (({BRDATA_SIZE*2{qren[0]}} &amp; {brdata1[BRDATA_SIZE-1:0],brdata0[BRDATA_SIZE-1:0]}) |</span>
<span id="L371"><span class="lineNum">     371</span>              :                                                                        ({BRDATA_SIZE*2{qren[1]}} &amp; {brdata2[BRDATA_SIZE-1:0],brdata1[BRDATA_SIZE-1:0]}) |</span>
<span id="L372"><span class="lineNum">     372</span>              :                                                                        ({BRDATA_SIZE*2{qren[2]}} &amp; {brdata0[BRDATA_SIZE-1:0],brdata2[BRDATA_SIZE-1:0]}));</span>
<span id="L373"><span class="lineNum">     373</span>              : </span>
<span id="L374"><span class="lineNum">     374</span>              :    assign brdata0final[BRDATA_SIZE-1:0] = (({BRDATA_SIZE{q0sel[0]}} &amp; {                     brdata0eff[2*BRDATA_WIDTH-1:0]}) |</span>
<span id="L375"><span class="lineNum">     375</span>              :                                            ({BRDATA_SIZE{q0sel[1]}} &amp; {{BRDATA_WIDTH{1'b0}},brdata0eff[BRDATA_SIZE-1:BRDATA_WIDTH]}));</span>
<span id="L376"><span class="lineNum">     376</span>              : </span>
<span id="L377"><span class="lineNum">     377</span>              :    assign brdata1final[BRDATA_SIZE-1:0] = (({BRDATA_SIZE{q1sel[0]}} &amp; {                     brdata1eff[2*BRDATA_WIDTH-1:0]}) |</span>
<span id="L378"><span class="lineNum">     378</span>              :                                            ({BRDATA_SIZE{q1sel[1]}} &amp; {{BRDATA_WIDTH{1'b0}},brdata1eff[BRDATA_SIZE-1:BRDATA_WIDTH]}));</span>
<span id="L379"><span class="lineNum">     379</span>              : </span>
<span id="L380"><span class="lineNum">     380</span>              :    end // if (pt.BTB_ENABLE==1)</span>
<span id="L381"><span class="lineNum">     381</span>              :    else begin</span>
<span id="L382"><span class="lineNum">     382</span>              :       assign {</span>
<span id="L383"><span class="lineNum">     383</span>              :                f1ictype[1:0]</span>
<span id="L384"><span class="lineNum">     384</span>              :                } = misc1eff[MHI:0];</span>
<span id="L385"><span class="lineNum">     385</span>              : </span>
<span id="L386"><span class="lineNum">     386</span>              :       assign {</span>
<span id="L387"><span class="lineNum">     387</span>              :                f0ictype[1:0]</span>
<span id="L388"><span class="lineNum">     388</span>              :                } = misc0eff[MHI:0];</span>
<span id="L389"><span class="lineNum">     389</span>              : </span>
<span id="L390"><span class="lineNum">     390</span>              :       assign brdata_in[BRDATA_SIZE-1:0] = {</span>
<span id="L391"><span class="lineNum">     391</span>              :                                             iccm_rd_ecc_double_err[1],ic_access_fault_f[1],</span>
<span id="L392"><span class="lineNum">     392</span>              :                                             iccm_rd_ecc_double_err[0],ic_access_fault_f[0]</span>
<span id="L393"><span class="lineNum">     393</span>              :                                             };</span>
<span id="L394"><span class="lineNum">     394</span>              :       assign {f0dbecc[1],f0icaf[1],</span>
<span id="L395"><span class="lineNum">     395</span>              :               f0dbecc[0],f0icaf[0]} = brdata0final[BRDATA_SIZE-1:0];</span>
<span id="L396"><span class="lineNum">     396</span>              : </span>
<span id="L397"><span class="lineNum">     397</span>              :       assign {f1dbecc[1],f1icaf[1],</span>
<span id="L398"><span class="lineNum">     398</span>              :               f1dbecc[0],f1icaf[0]} = brdata1final[BRDATA_SIZE-1:0];</span>
<span id="L399"><span class="lineNum">     399</span>              : </span>
<span id="L400"><span class="lineNum">     400</span>              :       assign {brdata1eff[BRDATA_SIZE-1:0],brdata0eff[BRDATA_SIZE-1:0]} = (({BRDATA_SIZE*2{qren[0]}} &amp; {brdata1[BRDATA_SIZE-1:0],brdata0[BRDATA_SIZE-1:0]}) |</span>
<span id="L401"><span class="lineNum">     401</span>              :                                                                           ({BRDATA_SIZE*2{qren[1]}} &amp; {brdata2[BRDATA_SIZE-1:0],brdata1[BRDATA_SIZE-1:0]}) |</span>
<span id="L402"><span class="lineNum">     402</span>              :                                                                           ({BRDATA_SIZE*2{qren[2]}} &amp; {brdata0[BRDATA_SIZE-1:0],brdata2[BRDATA_SIZE-1:0]}));</span>
<span id="L403"><span class="lineNum">     403</span>              : </span>
<span id="L404"><span class="lineNum">     404</span>              :       assign brdata0final[BRDATA_SIZE-1:0] = (({BRDATA_SIZE{q0sel[0]}} &amp; {                     brdata0eff[2*BRDATA_WIDTH-1:0]}) |</span>
<span id="L405"><span class="lineNum">     405</span>              :                                               ({BRDATA_SIZE{q0sel[1]}} &amp; {{BRDATA_WIDTH{1'b0}},brdata0eff[BRDATA_SIZE-1:BRDATA_WIDTH]}));</span>
<span id="L406"><span class="lineNum">     406</span>              : </span>
<span id="L407"><span class="lineNum">     407</span>              :       assign brdata1final[BRDATA_SIZE-1:0] = (({BRDATA_SIZE{q1sel[0]}} &amp; {                     brdata1eff[2*BRDATA_WIDTH-1:0]}) |</span>
<span id="L408"><span class="lineNum">     408</span>              :                                               ({BRDATA_SIZE{q1sel[1]}} &amp; {{BRDATA_WIDTH{1'b0}},brdata1eff[BRDATA_SIZE-1:BRDATA_WIDTH]}));</span>
<span id="L409"><span class="lineNum">     409</span>              : </span>
<span id="L410"><span class="lineNum">     410</span>              :    end // else: !if(pt.BTB_ENABLE==1)</span>
<span id="L411"><span class="lineNum">     411</span>              : </span>
<span id="L412"><span class="lineNum">     412</span>              : </span>
<span id="L413"><span class="lineNum">     413</span>              :    // possible states of { sf0_valid, sf1_valid, f2_valid }</span>
<span id="L414"><span class="lineNum">     414</span>              :    //</span>
<span id="L415"><span class="lineNum">     415</span>              :    // 000    if-&gt;f0</span>
<span id="L416"><span class="lineNum">     416</span>              :    // 100    if-&gt;f1</span>
<span id="L417"><span class="lineNum">     417</span>              :    // 101    illegal</span>
<span id="L418"><span class="lineNum">     418</span>              :    // 010    if-&gt;f1, f1-&gt;f0</span>
<span id="L419"><span class="lineNum">     419</span>              :    // 110    if-&gt;f2</span>
<span id="L420"><span class="lineNum">     420</span>              :    // 001    if-&gt;f1, f2-&gt;f0</span>
<span id="L421"><span class="lineNum">     421</span>              :    // 011    if-&gt;f2, f2-&gt;f1, f1-&gt;f0</span>
<span id="L422"><span class="lineNum">     422</span>              :    // 111   !if,     no shift</span>
<span id="L423"><span class="lineNum">     423</span>              : </span>
<span id="L424"><span class="lineNum">     424</span>              :    assign f2_valid           =  f2val[0];</span>
<span id="L425"><span class="lineNum">     425</span>              :    assign sf1_valid          =  sf1val[0];</span>
<span id="L426"><span class="lineNum">     426</span>              :    assign sf0_valid          =  sf0val[0];</span>
<span id="L427"><span class="lineNum">     427</span>              : </span>
<span id="L428"><span class="lineNum">     428</span>              :    // interface to fetch</span>
<span id="L429"><span class="lineNum">     429</span>              : </span>
<span id="L430"><span class="lineNum">     430</span>              :    assign consume_fb0        = ~sf0val[0] &amp; f0val[0];</span>
<span id="L431"><span class="lineNum">     431</span>              : </span>
<span id="L432"><span class="lineNum">     432</span>              :    assign consume_fb1        = ~sf1val[0] &amp; f1val[0];</span>
<span id="L433"><span class="lineNum">     433</span>              : </span>
<span id="L434"><span class="lineNum">     434</span>              :    assign ifu_fb_consume1    =  consume_fb0 &amp; ~consume_fb1 &amp; ~exu_flush_final;</span>
<span id="L435"><span class="lineNum">     435</span>              :    assign ifu_fb_consume2    =  consume_fb0 &amp;  consume_fb1 &amp; ~exu_flush_final;</span>
<span id="L436"><span class="lineNum">     436</span>              : </span>
<span id="L437"><span class="lineNum">     437</span>              :    assign ifvalid            =  ifu_fetch_val[0];</span>
<span id="L438"><span class="lineNum">     438</span>              : </span>
<span id="L439"><span class="lineNum">     439</span>              :    assign shift_f1_f0        =  ~sf0_valid &amp;  sf1_valid;</span>
<span id="L440"><span class="lineNum">     440</span>              :    assign shift_f2_f0        =  ~sf0_valid &amp; ~sf1_valid &amp;  f2_valid;</span>
<span id="L441"><span class="lineNum">     441</span>              :    assign shift_f2_f1        =  ~sf0_valid &amp;  sf1_valid &amp;  f2_valid;</span>
<span id="L442"><span class="lineNum">     442</span>              : </span>
<span id="L443"><span class="lineNum">     443</span>              :    assign fetch_to_f0        =  ~sf0_valid &amp; ~sf1_valid &amp; ~f2_valid &amp; ifvalid;</span>
<span id="L444"><span class="lineNum">     444</span>              : </span>
<span id="L445"><span class="lineNum">     445</span>              :    assign fetch_to_f1        = (~sf0_valid &amp; ~sf1_valid &amp;  f2_valid &amp; ifvalid)  |</span>
<span id="L446"><span class="lineNum">     446</span>              :                                (~sf0_valid &amp;  sf1_valid &amp; ~f2_valid &amp; ifvalid)  |</span>
<span id="L447"><span class="lineNum">     447</span>              :                                ( sf0_valid &amp; ~sf1_valid &amp; ~f2_valid &amp; ifvalid);</span>
<span id="L448"><span class="lineNum">     448</span>              : </span>
<span id="L449"><span class="lineNum">     449</span>              :    assign fetch_to_f2        = (~sf0_valid &amp;  sf1_valid &amp;  f2_valid &amp; ifvalid)  |</span>
<span id="L450"><span class="lineNum">     450</span>              :                                ( sf0_valid &amp;  sf1_valid &amp; ~f2_valid &amp; ifvalid);</span>
<span id="L451"><span class="lineNum">     451</span>              : </span>
<span id="L452"><span class="lineNum">     452</span>              : </span>
<span id="L453"><span class="lineNum">     453</span>              :    assign f2val_in[1:0]      = ({2{ fetch_to_f2 &amp;                               ~exu_flush_final}} &amp; ifu_fetch_val[1:0]) |</span>
<span id="L454"><span class="lineNum">     454</span>              :                                ({2{~fetch_to_f2 &amp; ~shift_f2_f1 &amp; ~shift_f2_f0 &amp; ~exu_flush_final}} &amp; f2val[1:0]        );</span>
<span id="L455"><span class="lineNum">     455</span>              : </span>
<span id="L456"><span class="lineNum">     456</span>              : </span>
<span id="L457"><span class="lineNum">     457</span>              :    assign sf1val[1:0]        = ({2{ f1_shift_2B}} &amp; {1'b0,f1val[1]}) |</span>
<span id="L458"><span class="lineNum">     458</span>              :                                ({2{~f1_shift_2B}} &amp; f1val[1:0]     );</span>
<span id="L459"><span class="lineNum">     459</span>              : </span>
<span id="L460"><span class="lineNum">     460</span>              :    assign f1val_in[1:0]      = ({2{ fetch_to_f1                               &amp; ~exu_flush_final}} &amp; ifu_fetch_val[1:0]) |</span>
<span id="L461"><span class="lineNum">     461</span>              :                                ({2{                shift_f2_f1                &amp; ~exu_flush_final}} &amp; f2val[1:0]        ) |</span>
<span id="L462"><span class="lineNum">     462</span>              :                                ({2{~fetch_to_f1 &amp; ~shift_f2_f1 &amp; ~shift_f1_f0 &amp; ~exu_flush_final}} &amp; sf1val[1:0]       );</span>
<span id="L463"><span class="lineNum">     463</span>              : </span>
<span id="L464"><span class="lineNum">     464</span>              : </span>
<span id="L465"><span class="lineNum">     465</span>              : </span>
<span id="L466"><span class="lineNum">     466</span>              :    assign sf0val[1:0]        = ({2{ shift_2B            }} &amp; {1'b0,f0val[1]}) |</span>
<span id="L467"><span class="lineNum">     467</span>              :                                ({2{~shift_2B &amp; ~shift_4B}} &amp; f0val[1:0]);</span>
<span id="L468"><span class="lineNum">     468</span>              : </span>
<span id="L469"><span class="lineNum">     469</span>              :    assign f0val_in[1:0]      = ({2{fetch_to_f0                                &amp; ~exu_flush_final}} &amp; ifu_fetch_val[1:0]) |</span>
<span id="L470"><span class="lineNum">     470</span>              :                                ({2{                shift_f2_f0                &amp; ~exu_flush_final}} &amp; f2val[1:0]        ) |</span>
<span id="L471"><span class="lineNum">     471</span>              :                                ({2{                               shift_f1_f0 &amp; ~exu_flush_final}} &amp; sf1val[1:0]       ) |</span>
<span id="L472"><span class="lineNum">     472</span>              :                                ({2{~fetch_to_f0 &amp; ~shift_f2_f0 &amp; ~shift_f1_f0 &amp; ~exu_flush_final}} &amp; sf0val[1:0]       );</span>
<span id="L473"><span class="lineNum">     473</span>              : </span>
<span id="L474"><span class="lineNum">     474</span>              :    assign {q1eff[31:0],q0eff[31:0]} = (({64{qren[0]}} &amp; {q1[31:0],q0[31:0]}) |</span>
<span id="L475"><span class="lineNum">     475</span>              :                                        ({64{qren[1]}} &amp; {q2[31:0],q1[31:0]}) |</span>
<span id="L476"><span class="lineNum">     476</span>              :                                        ({64{qren[2]}} &amp; {q0[31:0],q2[31:0]}));</span>
<span id="L477"><span class="lineNum">     477</span>              : </span>
<span id="L478"><span class="lineNum">     478</span>              :    assign q0final[31:0]      = ({32{q0sel[0]}} &amp; {      q0eff[31:0]}) |</span>
<span id="L479"><span class="lineNum">     479</span>              :                                ({32{q0sel[1]}} &amp; {16'b0,q0eff[31:16]});</span>
<span id="L480"><span class="lineNum">     480</span>              : </span>
<span id="L481"><span class="lineNum">     481</span>              :    assign q1final[15:0]      = ({16{q1sel[0]}} &amp; q1eff[15:0] ) |</span>
<span id="L482"><span class="lineNum">     482</span>              :                                ({16{q1sel[1]}} &amp; q1eff[31:16]);</span>
<span id="L483"><span class="lineNum">     483</span> <span class="tlaGNC">          18 :    logic [31:1] q0pceff, q0pcfinal;</span></span>
<span id="L484"><span class="lineNum">     484</span> <span class="tlaGNC">           6 :    logic [31:1] q1pceff;</span></span>
<span id="L485"><span class="lineNum">     485</span>              : </span>
<span id="L486"><span class="lineNum">     486</span>              :    assign {q1pceff[31:1],q0pceff[31:1]} = (({62{qren[0]}} &amp; {q1pc[31:1],q0pc[31:1]}) |</span>
<span id="L487"><span class="lineNum">     487</span>              :                                            ({62{qren[1]}} &amp; {q2pc[31:1],q1pc[31:1]}) |</span>
<span id="L488"><span class="lineNum">     488</span>              :                                            ({62{qren[2]}} &amp; {q0pc[31:1],q2pc[31:1]}));</span>
<span id="L489"><span class="lineNum">     489</span>              : </span>
<span id="L490"><span class="lineNum">     490</span>              : </span>
<span id="L491"><span class="lineNum">     491</span>              :    assign q0pcfinal[31:1]      = ({31{q0sel[0]}} &amp; ( q0pceff[31:1])) |</span>
<span id="L492"><span class="lineNum">     492</span>              :                                  ({31{q0sel[1]}} &amp; ( q0pceff[31:1] + 31'd1));</span>
<span id="L493"><span class="lineNum">     493</span>              : </span>
<span id="L494"><span class="lineNum">     494</span>              :    assign aligndata[31:0]    = ({32{ f0val[1]           }} &amp; {q0final[31:0]}) |</span>
<span id="L495"><span class="lineNum">     495</span>              :                                ({32{~f0val[1] &amp; f0val[0]}} &amp; {q1final[15:0],q0final[15:0]});</span>
<span id="L496"><span class="lineNum">     496</span>              : </span>
<span id="L497"><span class="lineNum">     497</span>              :    assign alignval[1:0]      = ({ 2{ f0val[1]           }} &amp; {2'b11}) |</span>
<span id="L498"><span class="lineNum">     498</span>              :                                ({ 2{~f0val[1] &amp; f0val[0]}} &amp; {f1val[0],1'b1});</span>
<span id="L499"><span class="lineNum">     499</span>              : </span>
<span id="L500"><span class="lineNum">     500</span>              :    assign alignicaf[1:0]    = ({ 2{ f0val[1]           }} &amp;  f0icaf[1:0]          ) |</span>
<span id="L501"><span class="lineNum">     501</span>              :                               ({ 2{~f0val[1] &amp; f0val[0]}} &amp; {f1icaf[0],f0icaf[0]});</span>
<span id="L502"><span class="lineNum">     502</span>              : </span>
<span id="L503"><span class="lineNum">     503</span>              :    assign aligndbecc[1:0]    = ({ 2{ f0val[1]           }} &amp;  f0dbecc[1:0]          ) |</span>
<span id="L504"><span class="lineNum">     504</span>              :                               ({ 2{~f0val[1] &amp; f0val[0]}} &amp; {f1dbecc[0],f0dbecc[0]});</span>
<span id="L505"><span class="lineNum">     505</span>              : </span>
<span id="L506"><span class="lineNum">     506</span>              :    if (pt.BTB_ENABLE==1) begin</span>
<span id="L507"><span class="lineNum">     507</span>              : </span>
<span id="L508"><span class="lineNum">     508</span>              :    // for branch prediction</span>
<span id="L509"><span class="lineNum">     509</span>              : </span>
<span id="L510"><span class="lineNum">     510</span>              :    assign alignbrend[1:0]    = ({ 2{ f0val[1]           }} &amp;  f0brend[1:0]          ) |</span>
<span id="L511"><span class="lineNum">     511</span>              :                                ({ 2{~f0val[1] &amp; f0val[0]}} &amp; {f1brend[0],f0brend[0]});</span>
<span id="L512"><span class="lineNum">     512</span>              : </span>
<span id="L513"><span class="lineNum">     513</span>              :    assign alignpc4[1:0]      = ({ 2{ f0val[1]           }} &amp;  f0pc4[1:0]        ) |</span>
<span id="L514"><span class="lineNum">     514</span>              :                                ({ 2{~f0val[1] &amp; f0val[0]}} &amp; {f1pc4[0],f0pc4[0]});</span>
<span id="L515"><span class="lineNum">     515</span>              : </span>
<span id="L516"><span class="lineNum">     516</span>              :       if(pt.BTB_FULLYA) begin</span>
<span id="L517"><span class="lineNum">     517</span>              :          assign alignindex[0]      = f0index[0];</span>
<span id="L518"><span class="lineNum">     518</span>              :          assign alignindex[1]      = f0val[1] ? f0index[1] : f1index[0];</span>
<span id="L519"><span class="lineNum">     519</span>              :       end</span>
<span id="L520"><span class="lineNum">     520</span>              : </span>
<span id="L521"><span class="lineNum">     521</span>              :    assign alignret[1:0]      = ({ 2{ f0val[1]           }} &amp;  f0ret[1:0]        ) |</span>
<span id="L522"><span class="lineNum">     522</span>              :                                ({ 2{~f0val[1] &amp; f0val[0]}} &amp; {f1ret[0],f0ret[0]});</span>
<span id="L523"><span class="lineNum">     523</span>              : </span>
<span id="L524"><span class="lineNum">     524</span>              :    assign alignway[1:0]      = ({ 2{ f0val[1]           }} &amp;  f0way[1:0]        ) |</span>
<span id="L525"><span class="lineNum">     525</span>              :                                ({ 2{~f0val[1] &amp; f0val[0]}} &amp; {f1way[0],f0way[0]});</span>
<span id="L526"><span class="lineNum">     526</span>              : </span>
<span id="L527"><span class="lineNum">     527</span>              :    assign alignhist1[1:0]    = ({ 2{ f0val[1]           }} &amp;  f0hist1[1:0]          ) |</span>
<span id="L528"><span class="lineNum">     528</span>              :                                ({ 2{~f0val[1] &amp; f0val[0]}} &amp; {f1hist1[0],f0hist1[0]});</span>
<span id="L529"><span class="lineNum">     529</span>              : </span>
<span id="L530"><span class="lineNum">     530</span>              :    assign alignhist0[1:0]    = ({ 2{ f0val[1]           }} &amp;  f0hist0[1:0]          ) |</span>
<span id="L531"><span class="lineNum">     531</span>              :                                ({ 2{~f0val[1] &amp; f0val[0]}} &amp; {f1hist0[0],f0hist0[0]});</span>
<span id="L532"><span class="lineNum">     532</span>              : </span>
<span id="L533"><span class="lineNum">     533</span>              :    assign secondpc[31:1]     = ({31{ f0val[1]           }} &amp;  (q0pceff[31:1] + 31'd1)) |</span>
<span id="L534"><span class="lineNum">     534</span>              :                                // you need the base pc for 2nd one only (4B max, 2B for the 1st and 2B for the 2nd)</span>
<span id="L535"><span class="lineNum">     535</span>              :                                ({31{~f0val[1] &amp; f0val[0]}} &amp;   q1pceff[31:1]      );</span>
<span id="L536"><span class="lineNum">     536</span>              : </span>
<span id="L537"><span class="lineNum">     537</span>              : </span>
<span id="L538"><span class="lineNum">     538</span>              :    assign firstpc[31:1]      =  q0pcfinal[31:1];</span>
<span id="L539"><span class="lineNum">     539</span>              :       end // if (pt.BTB_ENABLE==1)</span>
<span id="L540"><span class="lineNum">     540</span>              : </span>
<span id="L541"><span class="lineNum">     541</span>              :    assign alignfromf1[1]     =      ~f0val[1] &amp; f0val[0];</span>
<span id="L542"><span class="lineNum">     542</span>              : </span>
<span id="L543"><span class="lineNum">     543</span>              : </span>
<span id="L544"><span class="lineNum">     544</span>              :    assign ifu_i0_pc[31:1]    =  q0pcfinal[31:1];</span>
<span id="L545"><span class="lineNum">     545</span>              : </span>
<span id="L546"><span class="lineNum">     546</span>              : </span>
<span id="L547"><span class="lineNum">     547</span>              :    assign ifu_i0_pc4         =  first4B;</span>
<span id="L548"><span class="lineNum">     548</span>              : </span>
<span id="L549"><span class="lineNum">     549</span>              : </span>
<span id="L550"><span class="lineNum">     550</span>              :    assign ifu_i0_cinst[15:0] = aligndata[15:0];</span>
<span id="L551"><span class="lineNum">     551</span>              : </span>
<span id="L552"><span class="lineNum">     552</span>              :    assign first4B            = (aligndata[1:0] == 2'b11);</span>
<span id="L553"><span class="lineNum">     553</span>              :    assign first2B            = ~first4B;</span>
<span id="L554"><span class="lineNum">     554</span>              : </span>
<span id="L555"><span class="lineNum">     555</span>              :    assign ifu_i0_valid       = (first4B &amp; alignval[1]) |</span>
<span id="L556"><span class="lineNum">     556</span>              :                                (first2B &amp; alignval[0]);</span>
<span id="L557"><span class="lineNum">     557</span>              : </span>
<span id="L558"><span class="lineNum">     558</span>              :    // inst access fault on any byte of inst results in access fault for the inst</span>
<span id="L559"><span class="lineNum">     559</span>              :    assign ifu_i0_icaf        = (first4B &amp; (|alignicaf[1:0])) |</span>
<span id="L560"><span class="lineNum">     560</span>              :                                (first2B &amp;   alignicaf[0]   );</span>
<span id="L561"><span class="lineNum">     561</span>              : </span>
<span id="L562"><span class="lineNum">     562</span>              :    assign ifu_i0_icaf_type[1:0] = (first4B &amp; ~f0val[1] &amp; f0val[0] &amp; ~alignicaf[0] &amp; ~aligndbecc[0]) ? f1ictype[1:0] : f0ictype[1:0];</span>
<span id="L563"><span class="lineNum">     563</span>              : </span>
<span id="L564"><span class="lineNum">     564</span>              : </span>
<span id="L565"><span class="lineNum">     565</span>              :    assign icaf_eff[1:0] = alignicaf[1:0] | aligndbecc[1:0];</span>
<span id="L566"><span class="lineNum">     566</span>              : </span>
<span id="L567"><span class="lineNum">     567</span>              :    assign ifu_i0_icaf_second = first4B &amp; ~icaf_eff[0] &amp; icaf_eff[1];</span>
<span id="L568"><span class="lineNum">     568</span>              : </span>
<span id="L569"><span class="lineNum">     569</span>              :    assign ifu_i0_dbecc       = (first4B &amp; (|aligndbecc[1:0])) |</span>
<span id="L570"><span class="lineNum">     570</span>              :                                (first2B &amp;   aligndbecc[0]   );</span>
<span id="L571"><span class="lineNum">     571</span>              : </span>
<span id="L572"><span class="lineNum">     572</span>              : </span>
<span id="L573"><span class="lineNum">     573</span>              :    assign ifirst[31:0]       =  aligndata[31:0];</span>
<span id="L574"><span class="lineNum">     574</span>              : </span>
<span id="L575"><span class="lineNum">     575</span>              : </span>
<span id="L576"><span class="lineNum">     576</span>              :    assign ifu_i0_instr[31:0] = ({32{first4B &amp; alignval[1]}} &amp; ifirst[31:0]) |</span>
<span id="L577"><span class="lineNum">     577</span>              :                                ({32{first2B &amp; alignval[0]}} &amp; uncompress0[31:0]);</span>
<span id="L578"><span class="lineNum">     578</span>              : </span>
<span id="L579"><span class="lineNum">     579</span>              : if(pt.BTB_ENABLE==1) begin : genblock2</span>
<span id="L580"><span class="lineNum">     580</span>              : </span>
<span id="L581"><span class="lineNum">     581</span>              :    // if you detect br does not start on instruction boundary</span>
<span id="L582"><span class="lineNum">     582</span>              : </span>
<span id="L583"><span class="lineNum">     583</span>              :    el2_btb_addr_hash #(.pt(pt)) firsthash (.pc(firstpc [pt.BTB_INDEX3_HI:pt.BTB_INDEX1_LO]),</span>
<span id="L584"><span class="lineNum">     584</span>              :                                             .hash(firstpc_hash [pt.BTB_ADDR_HI:pt.BTB_ADDR_LO]));</span>
<span id="L585"><span class="lineNum">     585</span>              :    el2_btb_addr_hash #(.pt(pt)) secondhash(.pc(secondpc[pt.BTB_INDEX3_HI:pt.BTB_INDEX1_LO]),</span>
<span id="L586"><span class="lineNum">     586</span>              :                                             .hash(secondpc_hash[pt.BTB_ADDR_HI:pt.BTB_ADDR_LO]));</span>
<span id="L587"><span class="lineNum">     587</span>              : </span>
<span id="L588"><span class="lineNum">     588</span>              :    if(pt.BTB_FULLYA) begin</span>
<span id="L589"><span class="lineNum">     589</span>              :       assign firstbrtag_hash = firstpc;</span>
<span id="L590"><span class="lineNum">     590</span>              :       assign secondbrtag_hash = secondpc;</span>
<span id="L591"><span class="lineNum">     591</span>              :    end</span>
<span id="L592"><span class="lineNum">     592</span>              :    else begin</span>
<span id="L593"><span class="lineNum">     593</span>              :       if(pt.BTB_BTAG_FOLD) begin : btbfold</span>
<span id="L594"><span class="lineNum">     594</span>              :          el2_btb_tag_hash_fold #(.pt(pt)) first_brhash (.pc(firstpc [pt.BTB_ADDR_HI+pt.BTB_BTAG_SIZE+pt.BTB_BTAG_SIZE:pt.BTB_ADDR_HI+1]),</span>
<span id="L595"><span class="lineNum">     595</span>              :                                                          .hash(firstbrtag_hash [pt.BTB_BTAG_SIZE-1:0]));</span>
<span id="L596"><span class="lineNum">     596</span>              :          el2_btb_tag_hash_fold #(.pt(pt)) second_brhash(.pc(secondpc[pt.BTB_ADDR_HI+pt.BTB_BTAG_SIZE+pt.BTB_BTAG_SIZE:pt.BTB_ADDR_HI+1]),</span>
<span id="L597"><span class="lineNum">     597</span>              :                                                          .hash(secondbrtag_hash[pt.BTB_BTAG_SIZE-1:0]));</span>
<span id="L598"><span class="lineNum">     598</span>              :       end</span>
<span id="L599"><span class="lineNum">     599</span>              :       else begin : btbfold</span>
<span id="L600"><span class="lineNum">     600</span>              :          el2_btb_tag_hash #(.pt(pt)) first_brhash (.pc(firstpc [pt.BTB_ADDR_HI+pt.BTB_BTAG_SIZE+pt.BTB_BTAG_SIZE+pt.BTB_BTAG_SIZE:pt.BTB_ADDR_HI+1]),</span>
<span id="L601"><span class="lineNum">     601</span>              :                                                     .hash(firstbrtag_hash [pt.BTB_BTAG_SIZE-1:0]));</span>
<span id="L602"><span class="lineNum">     602</span>              :          el2_btb_tag_hash #(.pt(pt)) second_brhash(.pc(secondpc[pt.BTB_ADDR_HI+pt.BTB_BTAG_SIZE+pt.BTB_BTAG_SIZE+pt.BTB_BTAG_SIZE:pt.BTB_ADDR_HI+1]),</span>
<span id="L603"><span class="lineNum">     603</span>              :                                                     .hash(secondbrtag_hash[pt.BTB_BTAG_SIZE-1:0]));</span>
<span id="L604"><span class="lineNum">     604</span>              :       end</span>
<span id="L605"><span class="lineNum">     605</span>              :    end // else: !if(pt.BTB_FULLYA)</span>
<span id="L606"><span class="lineNum">     606</span>              : </span>
<span id="L607"><span class="lineNum">     607</span>              : </span>
<span id="L608"><span class="lineNum">     608</span>              :    // start_indexing - you want pc to be based on where the end of branch is prediction</span>
<span id="L609"><span class="lineNum">     609</span>              :    // normal indexing pc based that's incorrect now for pc4 cases it's pc4 + 2</span>
<span id="L610"><span class="lineNum">     610</span>              : </span>
<span id="L611"><span class="lineNum">     611</span> <span class="tlaGNC">           6 :    always_comb begin</span></span>
<span id="L612"><span class="lineNum">     612</span>              : </span>
<span id="L613"><span class="lineNum">     613</span> <span class="tlaGNC">           6 :       i0_brp                 = '0;</span></span>
<span id="L614"><span class="lineNum">     614</span>              : </span>
<span id="L615"><span class="lineNum">     615</span> <span class="tlaGNC">           6 :       i0_br_start_error      = (first4B &amp; alignval[1] &amp; alignbrend[0]);</span></span>
<span id="L616"><span class="lineNum">     616</span>              : </span>
<span id="L617"><span class="lineNum">     617</span> <span class="tlaGNC">           6 :       i0_brp.valid           = (first2B &amp; alignbrend[0]) |</span></span>
<span id="L618"><span class="lineNum">     618</span> <span class="tlaGNC">           6 :                                (first4B &amp; alignbrend[1]) |</span></span>
<span id="L619"><span class="lineNum">     619</span> <span class="tlaGNC">           6 :                                 i0_br_start_error;</span></span>
<span id="L620"><span class="lineNum">     620</span>              : </span>
<span id="L621"><span class="lineNum">     621</span> <span class="tlaGNC">           6 :       i0_brp_pc4             = (first2B &amp; alignpc4[0]) |</span></span>
<span id="L622"><span class="lineNum">     622</span> <span class="tlaGNC">           6 :                                (first4B &amp; alignpc4[1]);</span></span>
<span id="L623"><span class="lineNum">     623</span>              : </span>
<span id="L624"><span class="lineNum">     624</span> <span class="tlaGNC">           6 :       i0_brp.ret             = (first2B &amp; alignret[0]) |</span></span>
<span id="L625"><span class="lineNum">     625</span> <span class="tlaGNC">           6 :                                (first4B &amp; alignret[1]);</span></span>
<span id="L626"><span class="lineNum">     626</span>              : </span>
<span id="L627"><span class="lineNum">     627</span> <span class="tlaGNC">           6 :       i0_brp.way             = (first2B | alignbrend[0])  ?  alignway[0]  :  alignway[1];</span></span>
<span id="L628"><span class="lineNum">     628</span>              : </span>
<span id="L629"><span class="lineNum">     629</span> <span class="tlaGNC">           6 :       i0_brp.hist[1]         = (first2B &amp; alignhist1[0]) |</span></span>
<span id="L630"><span class="lineNum">     630</span> <span class="tlaGNC">           6 :                                (first4B &amp; alignhist1[1]);</span></span>
<span id="L631"><span class="lineNum">     631</span>              : </span>
<span id="L632"><span class="lineNum">     632</span> <span class="tlaGNC">           6 :       i0_brp.hist[0]         = (first2B &amp; alignhist0[0]) |</span></span>
<span id="L633"><span class="lineNum">     633</span> <span class="tlaGNC">           6 :                                (first4B &amp; alignhist0[1]);</span></span>
<span id="L634"><span class="lineNum">     634</span>              : </span>
<span id="L635"><span class="lineNum">     635</span> <span class="tlaGNC">           6 :       i0_ends_f1             =  first4B &amp; alignfromf1[1];</span></span>
<span id="L636"><span class="lineNum">     636</span>              : </span>
<span id="L637"><span class="lineNum">     637</span> <span class="tlaGNC">           6 :       i0_brp.toffset[11:0]   = (i0_ends_f1)  ?  f1poffset[11:0]  :  f0poffset[11:0];</span></span>
<span id="L638"><span class="lineNum">     638</span>              : </span>
<span id="L639"><span class="lineNum">     639</span> <span class="tlaGNC">           6 :       i0_brp.prett[31:1]     = (i0_ends_f1)  ?  f1prett[31:1]    :  f0prett[31:1];</span></span>
<span id="L640"><span class="lineNum">     640</span>              : </span>
<span id="L641"><span class="lineNum">     641</span> <span class="tlaGNC">           6 :       i0_brp.br_start_error  = i0_br_start_error;</span></span>
<span id="L642"><span class="lineNum">     642</span>              : </span>
<span id="L643"><span class="lineNum">     643</span> <span class="tlaGNC">           6 :       i0_brp.bank            = (first2B | alignbrend[0])  ?  firstpc[1]  :  secondpc[1];</span></span>
<span id="L644"><span class="lineNum">     644</span>              : </span>
<span id="L645"><span class="lineNum">     645</span> <span class="tlaGNC">           6 :       i0_brp.br_error        = (i0_brp.valid &amp;  i0_brp_pc4 &amp;  first2B) |</span></span>
<span id="L646"><span class="lineNum">     646</span> <span class="tlaGNC">           6 :                                (i0_brp.valid &amp; ~i0_brp_pc4 &amp;  first4B);</span></span>
<span id="L647"><span class="lineNum">     647</span>              : </span>
<span id="L648"><span class="lineNum">     648</span> <span class="tlaGNC">           6 :       if(pt.BTB_FULLYA)</span></span>
<span id="L649"><span class="lineNum">     649</span> <span class="tlaUNC tlaBgUNC">           0 :         ifu_i0_fa_index = (first2B | alignbrend[0])  ?  alignindex[0]  :  alignindex[1];</span></span>
<span id="L650"><span class="lineNum">     650</span>              :       else</span>
<span id="L651"><span class="lineNum">     651</span> <span class="tlaGNC tlaBgGNC">           6 :         ifu_i0_fa_index = '0;</span></span>
<span id="L652"><span class="lineNum">     652</span>              : </span>
<span id="L653"><span class="lineNum">     653</span>              :  end</span>
<span id="L654"><span class="lineNum">     654</span>              : </span>
<span id="L655"><span class="lineNum">     655</span>              : </span>
<span id="L656"><span class="lineNum">     656</span>              :    assign ifu_i0_bp_index[pt.BTB_ADDR_HI:pt.BTB_ADDR_LO] = (first2B | alignbrend[0])  ?  firstpc_hash[pt.BTB_ADDR_HI:pt.BTB_ADDR_LO]  :</span>
<span id="L657"><span class="lineNum">     657</span>              :                                                                                          secondpc_hash[pt.BTB_ADDR_HI:pt.BTB_ADDR_LO];</span>
<span id="L658"><span class="lineNum">     658</span>              : </span>
<span id="L659"><span class="lineNum">     659</span>              :    assign ifu_i0_bp_fghr[pt.BHT_GHR_SIZE-1:0]            = (i0_ends_f1)               ?  f1fghr[pt.BHT_GHR_SIZE-1:0]  :</span>
<span id="L660"><span class="lineNum">     660</span>              :                                                                                          f0fghr[pt.BHT_GHR_SIZE-1:0];</span>
<span id="L661"><span class="lineNum">     661</span>              : </span>
<span id="L662"><span class="lineNum">     662</span>              :    assign ifu_i0_bp_btag[pt.BTB_BTAG_SIZE-1:0]           = (first2B | alignbrend[0])  ?  firstbrtag_hash[pt.BTB_BTAG_SIZE-1:0]  :</span>
<span id="L663"><span class="lineNum">     663</span>              :                                                                                          secondbrtag_hash[pt.BTB_BTAG_SIZE-1:0];</span>
<span id="L664"><span class="lineNum">     664</span>              : end</span>
<span id="L665"><span class="lineNum">     665</span>              : else begin</span>
<span id="L666"><span class="lineNum">     666</span>              :    assign i0_brp = '0;</span>
<span id="L667"><span class="lineNum">     667</span>              :    assign ifu_i0_bp_index = '0;</span>
<span id="L668"><span class="lineNum">     668</span>              :    assign ifu_i0_bp_fghr = '0;</span>
<span id="L669"><span class="lineNum">     669</span>              :    assign ifu_i0_bp_btag = '0;</span>
<span id="L670"><span class="lineNum">     670</span>              : end // else: !if(pt.BTB_ENABLE==1)</span>
<span id="L671"><span class="lineNum">     671</span>              : </span>
<span id="L672"><span class="lineNum">     672</span>              :    // decompress</span>
<span id="L673"><span class="lineNum">     673</span>              : </span>
<span id="L674"><span class="lineNum">     674</span>              :    // quiet inputs for 4B inst</span>
<span id="L675"><span class="lineNum">     675</span>              :    el2_ifu_compress_ctl compress0 (.din((first2B) ? aligndata[15:0] : '0), .dout(uncompress0[31:0]));</span>
<span id="L676"><span class="lineNum">     676</span>              : </span>
<span id="L677"><span class="lineNum">     677</span>              : </span>
<span id="L678"><span class="lineNum">     678</span>              : </span>
<span id="L679"><span class="lineNum">     679</span>              :    assign i0_shift           =  dec_i0_decode_d &amp; ~error_stall;</span>
<span id="L680"><span class="lineNum">     680</span>              : </span>
<span id="L681"><span class="lineNum">     681</span>              :    assign ifu_pmu_instr_aligned = i0_shift;</span>
<span id="L682"><span class="lineNum">     682</span>              : </span>
<span id="L683"><span class="lineNum">     683</span>              : </span>
<span id="L684"><span class="lineNum">     684</span>              :    // compute how many bytes are being shifted from f0</span>
<span id="L685"><span class="lineNum">     685</span>              : </span>
<span id="L686"><span class="lineNum">     686</span>              :    assign shift_2B           =  i0_shift &amp; first2B;</span>
<span id="L687"><span class="lineNum">     687</span>              : </span>
<span id="L688"><span class="lineNum">     688</span>              :    assign shift_4B           =  i0_shift &amp; first4B;</span>
<span id="L689"><span class="lineNum">     689</span>              : </span>
<span id="L690"><span class="lineNum">     690</span>              :    // exact equations for the queue logic</span>
<span id="L691"><span class="lineNum">     691</span>              :    assign f0_shift_2B        = (shift_2B &amp; f0val[0]            ) |</span>
<span id="L692"><span class="lineNum">     692</span>              :                                (shift_4B &amp; f0val[0] &amp; ~f0val[1]);</span>
<span id="L693"><span class="lineNum">     693</span>              : </span>
<span id="L694"><span class="lineNum">     694</span>              : </span>
<span id="L695"><span class="lineNum">     695</span>              :    // f0 valid states</span>
<span id="L696"><span class="lineNum">     696</span>              :    //     11</span>
<span id="L697"><span class="lineNum">     697</span>              :    //     10</span>
<span id="L698"><span class="lineNum">     698</span>              :    //     00</span>
<span id="L699"><span class="lineNum">     699</span>              : </span>
<span id="L700"><span class="lineNum">     700</span>              :    assign f1_shift_2B        =  f0val[0] &amp; ~f0val[1] &amp; shift_4B;</span>
<span id="L701"><span class="lineNum">     701</span>              : </span>
<span id="L702"><span class="lineNum">     702</span>              : </span>
<span id="L703"><span class="lineNum">     703</span>              : </span>
<span id="L704"><span class="lineNum">     704</span>              : endmodule</span>
        </pre>
</td>
</tr>
</table>

</body>
</html>
